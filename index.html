<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TKA by Hanzzy - Tes Kemampuan Akademik</title>
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <style>
        /* ===== RESET & BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        body {
            background: #f0f4f8;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
        }

        /* ===== LOGIN PAGE ===== */
        .login-container {
            background: white;
            border-radius: 40px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            padding: 50px 40px;
            max-width: 600px;
            margin: 0 auto;
        }

        .welcome-box {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            border-radius: 30px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
            color: white;
            font-weight: 700;
            font-size: 1.8rem;
            letter-spacing: 1px;
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        }

        .login-container h1 {
            font-size: 2.8rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 10px;
            text-align: center;
        }

        .login-container h1 span {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .login-container .sub {
            color: #64748b;
            font-size: 1.2rem;
            margin-bottom: 30px;
            text-align: center;
        }

        .token-box {
            background: #f1f5f9;
            border-radius: 30px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px dashed #94a3b8;
        }

        .token-label {
            font-size: 1.2rem;
            color: #475569;
            margin-bottom: 10px;
            text-align: center;
        }

        .token-value {
            font-family: monospace;
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: 8px;
            color: #2563eb;
            background: white;
            padding: 15px 20px;
            border-radius: 60px;
            border: 2px solid #cbd5e1;
            display: inline-block;
            width: 100%;
            text-align: center;
        }

        .input-group {
            text-align: left;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: #334155;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #cbd5e1;
            border-radius: 60px;
            font-size: 1.2rem;
            outline: none;
            transition: 0.15s;
            background: white;
        }

        .input-group input:focus,
        .input-group select:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }

        .gender-group {
            display: flex;
            gap: 30px;
            align-items: center;
            padding: 10px 0;
        }

        .gender-group label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            color: #334155;
            font-size: 1.2rem;
            cursor: pointer;
        }

        .gender-group input[type="radio"] {
            width: 20px;
            height: 20px;
            accent-color: #2563eb;
        }

        .tanggal-lahir {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .tanggal-lahir select {
            flex: 1;
            min-width: 100px;
        }

        .btn-login {
            background: #2563eb;
            color: white;
            font-size: 1.8rem;
            font-weight: 600;
            padding: 16px 30px;
            border: none;
            border-radius: 70px;
            width: 100%;
            cursor: pointer;
            box-shadow: 0 8px 0 #1e40af;
            transition: 0.1s;
            margin-top: 15px;
        }

        .btn-login:active {
            transform: translateY(5px);
            box-shadow: 0 3px 0 #1e40af;
        }

        .error-message {
            color: #ef4444;
            font-size: 1rem;
            margin-top: 15px;
            min-height: 20px;
            text-align: center;
        }

        .penalty-message {
            background: #fee2e2;
            border: 2px solid #ef4444;
            color: #b91c1c;
            padding: 15px;
            border-radius: 30px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        /* ===== KARAKTER PAGE ===== */
        .karakter-page,
        .soal-page,
        .konfirmasi-page,
        .pilih-mapel-page {
            display: none;
        }

        .header-card {
            background: white;
            border-radius: 24px;
            padding: 25px 35px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 10px solid #2563eb;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-card h2 {
            font-size: 2rem;
            font-weight: 600;
            color: #0f172a;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-card h2 i {
            color: #2563eb;
            font-size: 2.2rem;
        }

        .user-info {
            background: #f1f5f9;
            padding: 10px 25px;
            border-radius: 50px;
            font-size: 1.2rem;
            color: #1e293b;
            border: 2px solid #cbd5e1;
        }

        .timer {
            background: #f1f5f9;
            padding: 12px 28px;
            border-radius: 50px;
            font-size: 1.6rem;
            font-weight: 700;
            color: #0f172a;
            border: 2px solid #cbd5e1;
            letter-spacing: 1px;
        }

        .battery {
            background: #f1f5f9;
            padding: 8px 20px;
            border-radius: 40px;
            font-size: 1.3rem;
            font-weight: 600;
            color: #0f172a;
            border: 2px solid #cbd5e1;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .battery i {
            font-size: 1.5rem;
            color: #2563eb;
        }

        /* ===== SOAL WRAPPER (DESKTOP OPTIMIZED) ===== */
        .soal-wrapper {
            display: flex;
            flex-direction: column;
            gap: 25px;
            max-height: 700px;
            overflow-y: auto;
            padding-right: 15px;
        }

        .soal-card {
            background: white;
            border-radius: 24px;
            padding: 30px 35px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.03);
            border: 1px solid #e9eef3;
            transition: box-shadow 0.2s;
        }

        .soal-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.05);
        }

        .soal-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .soal-nomor {
            background: #2563eb;
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.4rem;
            box-shadow: 0 6px 12px rgba(37, 99, 235, 0.25);
        }

        .soal-tipe {
            background: #dbeafe;
            color: #1e40af;
            padding: 6px 20px;
            border-radius: 40px;
            font-size: 1rem;
            font-weight: 600;
        }

        .soal-teks {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #1e293b;
            margin: 15px 0 25px;
            white-space: pre-line;
            background: #f8fafc;
            padding: 25px;
            border-radius: 18px;
            border-left: 6px solid #2563eb;
            text-align: justify;
        }

        .opsi {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .opsi-item {
            display: flex;
            align-items: center;
            gap: 20px;
            background: #f9fafc;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.15s;
            font-size: 1.1rem;
        }

        .opsi-item:hover {
            background: #eff6ff;
            border-color: #2563eb;
            transform: translateX(5px);
        }

        .opsi-item input {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: #2563eb;
        }

        .opsi-item label {
            flex: 1;
            font-size: 1.1rem;
            cursor: pointer;
            color: #1e293b;
            font-weight: 500;
        }

        .btn-submit {
            background: #10b981;
            color: white;
            font-size: 2rem;
            font-weight: 600;
            padding: 20px 40px;
            border: none;
            border-radius: 70px;
            width: 100%;
            max-width: 400px;
            margin: 40px auto 0;
            display: block;
            cursor: pointer;
            box-shadow: 0 8px 0 #059669;
            transition: 0.1s;
        }

        .btn-submit:active {
            transform: translateY(5px);
            box-shadow: 0 3px 0 #059669;
        }

        .error-submit {
            color: #ef4444;
            text-align: center;
            margin: 10px 0;
            font-size: 1.1rem;
        }

        /* ===== KONFIRMASI PAGE ===== */
        .konfirmasi-card {
            background: white;
            border-radius: 40px;
            padding: 60px;
            text-align: center;
            max-width: 700px;
            margin: 50px auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 2px solid #2563eb;
        }

        .konfirmasi-card h2 {
            font-size: 3rem;
            color: #2563eb;
            margin-bottom: 25px;
        }

        .konfirmasi-info {
            font-size: 2rem;
            font-weight: 600;
            color: #1e293b;
            margin: 20px 0;
        }

        .konfirmasi-info span {
            color: #2563eb;
        }

        .konfirmasi-pesan {
            font-size: 1.6rem;
            color: #334155;
            margin: 40px 0;
            font-style: italic;
        }

        .btn-lanjut {
            background: #2563eb;
            color: white;
            font-size: 2.2rem;
            font-weight: 700;
            padding: 25px 50px;
            border: none;
            border-radius: 80px;
            cursor: pointer;
            box-shadow: 0 8px 0 #1e40af;
            transition: 0.1s;
            width: 100%;
            max-width: 450px;
            margin: 20px auto;
        }

        .btn-lanjut:active {
            transform: translateY(5px);
            box-shadow: 0 3px 0 #1e40af;
        }

        /* ===== PILIH MAPEL PAGE ===== */
        .pilih-mapel-page {
            background: white;
            border-radius: 32px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            padding: 60px 40px;
            text-align: center;
        }

        .pilih-mapel-page h1 {
            font-size: 3.2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 15px;
        }

        .pilih-mapel-page h1 span {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .pilih-mapel-page .sub {
            color: #64748b;
            font-size: 1.3rem;
            margin-bottom: 40px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 25px;
        }

        .card-grid {
            display: flex;
            gap: 40px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .home-card {
            background: #f8fafc;
            width: 320px;
            padding: 50px 30px;
            border-radius: 28px;
            cursor: pointer;
            transition: all 0.25s;
            border: 2px solid transparent;
        }

        .home-card:hover {
            border-color: #2563eb;
            transform: translateY(-6px);
            box-shadow: 0 15px 30px rgba(37, 99, 235, 0.1);
        }

        .home-card i {
            font-size: 5rem;
            color: #2563eb;
            margin-bottom: 25px;
        }

        .home-card h2 {
            font-size: 2.5rem;
            font-weight: 600;
            color: #0f172a;
        }

        .home-card p {
            color: #475569;
            font-size: 1.2rem;
            margin-top: 15px;
        }

        /* ===== MODAL SELESAI ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: 0.2s;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-card {
            background: white;
            max-width: 500px;
            width: 90%;
            border-radius: 40px;
            padding: 50px 40px;
            text-align: center;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .modal-card i {
            font-size: 5rem;
            color: #f59e0b;
            margin-bottom: 25px;
        }

        .modal-card h3 {
            font-size: 2.2rem;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 15px;
        }

        .modal-card p {
            font-size: 1.3rem;
            color: #475569;
            margin-bottom: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .modal-actions .modal-btn {
            width: auto;
            padding: 16px 35px;
            font-size: 1.4rem;
            border: none;
            border-radius: 60px;
            cursor: pointer;
            box-shadow: 0 5px 0 #059669;
            transition: 0.1s;
            font-weight: 600;
        }

        .modal-actions .modal-btn.primary {
            background: #10b981;
            color: white;
            box-shadow: 0 5px 0 #059669;
        }

        .modal-actions .modal-btn.secondary {
            background: #94a3b8;
            color: white;
            box-shadow: 0 5px 0 #64748b;
        }

        .modal-actions .modal-btn:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #059669;
        }

        /* ===== HASIL PANEL ===== */
        .hasil-panel {
            background: white;
            border-radius: 32px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            margin-top: 30px;
        }

        .nilai-box {
            background: #f1f5f9;
            padding: 25px 40px;
            border-radius: 70px;
            font-size: 2.2rem;
            font-weight: 700;
            display: inline-block;
            color: #0f172a;
            border: 2px solid #cbd5e1;
        }

        .key-area {
            background: #f1f5f9;
            border-radius: 35px;
            padding: 35px;
            margin: 30px 0;
            border: 2px dashed #94a3b8;
        }

        .key-string {
            font-family: monospace;
            font-size: 2.5rem;
            background: white;
            padding: 15px 35px;
            border-radius: 60px;
            display: inline-block;
            letter-spacing: 4px;
            border: 2px solid #94a3b8;
            color: #0f172a;
            margin: 15px 0;
            word-break: break-all;
        }

        .exit-form {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            background: #f1f5f9;
            padding: 30px;
            border-radius: 60px;
        }

        .exit-form input {
            flex: 2;
            min-width: 250px;
            background: white;
            border: 2px solid #cbd5e1;
            padding: 18px 25px;
            border-radius: 60px;
            font-size: 1.4rem;
            color: #0f172a;
            text-align: center;
            font-family: monospace;
            outline: none;
        }

        .exit-form button {
            flex: 1;
            background: #ef4444;
            border: none;
            padding: 18px 25px;
            border-radius: 60px;
            font-weight: 600;
            font-size: 1.5rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 6px 0 #b91c1c;
            border: 1px solid #fecaca;
        }

        .exit-form button:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #b91c1c;
        }

        .peringatan {
            color: #475569;
            font-size: 1.1rem;
            margin-top: 25px;
            text-align: center;
        }

        .rincian-item {
            margin: 20px 0;
            padding: 20px;
            border-radius: 20px;
            background: #f8fafc;
            border-left: 6px solid;
        }

        .rincian-item.benar {
            border-left-color: #10b981;
        }

        .rincian-item.salah {
            border-left-color: #ef4444;
        }

        .rincian-header {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .jawaban-user {
            color: #1e293b;
            font-size: 1.1rem;
        }

        .kunci-jawaban {
            color: #2563eb;
            font-weight: 500;
            font-size: 1.1rem;
            margin-top: 5px;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: #64748b;
            font-size: 1rem;
        }

        /* ===== SCROLLBAR ===== */
        .soal-wrapper::-webkit-scrollbar {
            width: 10px;
        }

        .soal-wrapper::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }

        .soal-wrapper::-webkit-scrollbar-thumb {
            background: #2563eb;
            border-radius: 10px;
        }

        .soal-wrapper::-webkit-scrollbar-thumb:hover {
            background: #1e40af;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 600px) {
            .login-container {
                padding: 30px 20px;
            }

            .welcome-box {
                font-size: 1.4rem;
                padding: 15px;
            }

            .token-value {
                font-size: 1.8rem;
                letter-spacing: 4px;
            }

            .gender-group {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .tanggal-lahir select {
                min-width: 80px;
            }

            .konfirmasi-card {
                padding: 30px;
            }

            .konfirmasi-card h2 {
                font-size: 2rem;
            }

            .home-card {
                width: 280px;
                padding: 40px 20px;
            }

            .soal-card {
                padding: 20px;
            }

            .soal-teks {
                font-size: 1.1rem;
                padding: 15px;
            }

            .opsi-item {
                padding: 12px 18px;
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- HALAMAN LOGIN -->
        <div id="loginPage" class="login-container">
            <div class="welcome-box">SELAMAT DATANG DI TES KEMAMPUAN AKADEMIK BY HANZZY</div>
            <h1><span>TKA</span> by Hanzzy</h1>
            <div class="sub">Masukkan token dan data diri untuk memulai</div>
            <div id="penaltyMessage" class="penalty-message" style="display: none;"></div>
            <div class="token-box">
                <div class="token-label">Token Akses</div>
                <div class="token-value" id="tokenDisplay">ABCD12</div>
            </div>
            <div class="input-group"><label>Masukkan Token</label><input type="text" id="tokenInput" placeholder="Salin token di atas" autocomplete="off"></div>
            <div class="input-group"><label>Nama Lengkap</label><input type="text" id="namaInput" placeholder="Masukkan nama Anda" autocomplete="off"></div>
            <div class="input-group"><label>Jenis Kelamin</label>
                <div class="gender-group">
                    <label><input type="radio" name="gender" value="Laki-laki" checked> Laki-laki</label>
                    <label><input type="radio" name="gender" value="Perempuan"> Perempuan</label>
                </div>
            </div>
            <div class="input-group"><label>Tanggal Lahir</label>
                <div class="tanggal-lahir">
                    <select id="tgl" required>
                        <option value="">Tanggal</option>
                    </select>
                    <select id="bln" required>
                        <option value="">Bulan</option>
                    </select>
                    <select id="thn" required>
                        <option value="">Tahun</option>
                    </select>
                </div>
            </div>
            <button class="btn-login" id="btnLogin">MASUK</button>
            <div class="error-message" id="loginError"></div>
        </div>

        <!-- TES KARAKTER (5 SOAL) -->
        <div id="karakterPage" class="karakter-page">
            <div class="header-card">
                <h2><i class="fas fa-user-check"></i> Tes Karakter Siswa</h2>
                <div class="user-info" id="karakterUser">User</div>
                <div class="timer" id="karakterTimer">00:10:00</div>
            </div>
            <div class="soal-wrapper" id="karakterSoalContainer"></div>
            <button class="btn-submit" id="submitKarakter">Lanjut ke Pilihan Mapel</button>
            <div id="karakterError" class="error-submit"></div>
        </div>

        <!-- HALAMAN PILIH MAPEL -->
        <div id="pilihMapelPage" class="pilih-mapel-page">
            <h1>Pilih Mata Pelajaran</h1>
            <div class="sub">Tes Kemampuan Akademik</div>
            <div class="card-grid">
                <div class="home-card" id="btnIndo">
                    <i class="fas fa-book-open"></i>
                    <h2>B.Indonesia</h2>
                    <p>25 soal | 90 menit</p>
                </div>
                <div class="home-card" id="btnMat">
                    <i class="fas fa-calculator"></i>
                    <h2>Matematika</h2>
                    <p>25 soal | 90 menit</p>
                </div>
            </div>
        </div>

        <!-- HALAMAN KONFIRMASI SEBELUM SOAL -->
        <div id="konfirmasiPage" class="konfirmasi-page">
            <div class="konfirmasi-card">
                <h2 id="konfirmasiMapel">BAHASA INDONESIA</h2>
                <div class="konfirmasi-info">WAKTU : <span>90 MENIT</span></div>
                <div class="konfirmasi-info">SOAL : <span>25 SOAL</span></div>
                <div class="konfirmasi-pesan">Pastikan anda sudah berdoa menurut agama dan keyakinan masing-masing.</div>
                <button class="btn-lanjut" id="btnLanjutSoal">LANJUT KE SOAL</button>
            </div>
        </div>

        <!-- HALAMAN SOAL BAHASA INDONESIA -->
        <div id="indoPage" class="soal-page">
            <div class="header-card">
                <h2><i class="fas fa-book-open"></i> Bahasa Indonesia</h2>
                <div class="user-info" id="indoUser">User</div>
                <div class="timer" id="indoTimer">01:30:00</div>
                <div class="battery" id="batteryDisplay"><i class="fas fa-battery-full"></i> <span>100%</span></div>
            </div>
            <div class="soal-wrapper" id="indoSoalContainer"></div>
            <button class="btn-submit" id="submitIndo">Selesai & Lihat Hasil</button>
            <div id="indoError" class="error-submit"></div>
        </div>

        <!-- HALAMAN SOAL MATEMATIKA -->
        <div id="matPage" class="soal-page">
            <div class="header-card">
                <h2><i class="fas fa-calculator"></i> Matematika</h2>
                <div class="user-info" id="matUser">User</div>
                <div class="timer" id="matTimer">01:30:00</div>
                <div class="battery" id="batteryDisplayMat"><i class="fas fa-battery-full"></i> <span>100%</span></div>
            </div>
            <div class="soal-wrapper" id="matSoalContainer"></div>
            <button class="btn-submit" id="submitMat">Selesai & Lihat Hasil</button>
            <div id="matError" class="error-submit"></div>
        </div>

        <!-- MODAL KONFIRMASI SELESAI UJIAN -->
        <div id="modalSelesai" class="modal-overlay">
            <div class="modal-card">
                <i class="fas fa-question-circle"></i>
                <h3>Yakin ingin mengakhiri ujian?</h3>
                <p>Pastikan semua jawaban sudah final. Anda tidak dapat mengubahnya setelah ini.</p>
                <div class="modal-actions">
                    <button class="modal-btn secondary" id="batalSelesai">Tidak</button>
                    <button class="modal-btn primary" id="konfirmasiSelesai">Ya</button>
                </div>
            </div>
        </div>

        <!-- HALAMAN HASIL AKHIR -->
        <div id="hasilPage" class="soal-page">
            <div class="hasil-panel" id="hasilPanel"></div>
        </div>
    </div>

    <script>
        (function () {
            // ==================== BANK SOAL BAHASA INDONESIA (30 SOAL DENGAN TEKS PANJANG) ====================
            const bankIndo = [
                // TEKS 1 - Perpustakaan Sekolah (6 soal) [citation:1]
                {
                    tipe: 'pg', teks: `Perpustakaan sekolah kini berfungsi sebagai pusat belajar siswa. Selain menyediakan buku pelajaran, perpustakaan juga memiliki koleksi buku pengayaan dan karya sastra. Siswa dapat memanfaatkan fasilitas ini untuk belajar mandiri. Guru sering mendorong siswa mencari referensi tambahan dari perpustakaan. Dengan demikian, perpustakaan berperan penting dalam menunjang kegiatan belajar.

Topik utama teks tersebut adalah...`,
                    opsi: [{ teks: 'Kegiatan guru', nilai: 'A' }, { teks: 'Fungsi perpustakaan sekolah', nilai: 'B' }, { teks: 'Buku pelajaran', nilai: 'C' }, { teks: 'Cara belajar siswa', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Perpustakaan sekolah kini berfungsi sebagai pusat belajar siswa. Selain menyediakan buku pelajaran, perpustakaan juga memiliki koleksi buku pengayaan dan karya sastra. Siswa dapat memanfaatkan fasilitas ini untuk belajar mandiri. Guru sering mendorong siswa mencari referensi tambahan dari perpustakaan. Dengan demikian, perpustakaan berperan penting dalam menunjang kegiatan belajar.

Koleksi yang tersedia di perpustakaan menurut teks adalah...`,
                    opsi: [{ teks: 'Buku pelajaran saja', nilai: 'A' }, { teks: 'Buku sastra saja', nilai: 'B' }, { teks: 'Berbagai jenis buku', nilai: 'C' }, { teks: 'Buku lama', nilai: 'D' }], kunci: 'C'
                },
                {
                    tipe: 'pg', teks: `Perpustakaan sekolah kini berfungsi sebagai pusat belajar siswa. Selain menyediakan buku pelajaran, perpustakaan juga memiliki koleksi buku pengayaan dan karya sastra. Siswa dapat memanfaatkan fasilitas ini untuk belajar mandiri. Guru sering mendorong siswa mencari referensi tambahan dari perpustakaan. Dengan demikian, perpustakaan berperan penting dalam menunjang kegiatan belajar.

Tujuan siswa memanfaatkan perpustakaan adalah...`,
                    opsi: [{ teks: 'Mengisi waktu luang', nilai: 'A' }, { teks: 'Menunjang belajar', nilai: 'B' }, { teks: 'Menjual buku', nilai: 'C' }, { teks: 'Menghindari pelajaran', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Perpustakaan sekolah kini berfungsi sebagai pusat belajar siswa. Selain menyediakan buku pelajaran, perpustakaan juga memiliki koleksi buku pengayaan dan karya sastra. Siswa dapat memanfaatkan fasilitas ini untuk belajar mandiri. Guru sering mendorong siswa mencari referensi tambahan dari perpustakaan. Dengan demikian, perpustakaan berperan penting dalam menunjang kegiatan belajar.

Peran guru dalam teks adalah...`,
                    opsi: [{ teks: 'Menjaga perpustakaan', nilai: 'A' }, { teks: 'Mengatur jadwal', nilai: 'B' }, { teks: 'Mendorong siswa mencari referensi', nilai: 'C' }, { teks: 'Menyusun koleksi buku', nilai: 'D' }], kunci: 'C'
                },
                {
                    tipe: 'pg', teks: `Perpustakaan sekolah kini berfungsi sebagai pusat belajar siswa. Selain menyediakan buku pelajaran, perpustakaan juga memiliki koleksi buku pengayaan dan karya sastra. Siswa dapat memanfaatkan fasilitas ini untuk belajar mandiri. Guru sering mendorong siswa mencari referensi tambahan dari perpustakaan. Dengan demikian, perpustakaan berperan penting dalam menunjang kegiatan belajar.

Ringkasan yang tepat untuk teks tersebut adalah...`,
                    opsi: [{ teks: 'Siswa gemar membaca', nilai: 'A' }, { teks: 'Perpustakaan menunjang kegiatan belajar', nilai: 'B' }, { teks: 'Buku sastra paling diminati', nilai: 'C' }, { teks: 'Guru wajib ke perpustakaan', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 2 - Polusi Udara (5 soal) [citation:1]
                {
                    tipe: 'pg', teks: `Polusi udara di kota besar semakin meningkat dari tahun ke tahun. Padatnya kendaraan bermotor menjadi penyumbang utama pencemaran udara. Aktivitas industri juga memperburuk kualitas udara. Kondisi ini berdampak pada kesehatan masyarakat. Anak-anak dan lansia menjadi kelompok yang paling rentan.

Masalah utama yang dibahas dalam teks adalah...`,
                    opsi: [{ teks: 'Kemacetan', nilai: 'A' }, { teks: 'Polusi udara', nilai: 'B' }, { teks: 'Sampah kota', nilai: 'C' }, { teks: 'Banjir', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Polusi udara di kota besar semakin meningkat dari tahun ke tahun. Padatnya kendaraan bermotor menjadi penyumbang utama pencemaran udara. Aktivitas industri juga memperburuk kualitas udara. Kondisi ini berdampak pada kesehatan masyarakat. Anak-anak dan lansia menjadi kelompok yang paling rentan.

Penyebab utama polusi udara menurut teks adalah...`,
                    opsi: [{ teks: 'Limbah rumah tangga', nilai: 'A' }, { teks: 'Asap kendaraan dan industri', nilai: 'B' }, { teks: 'Kebakaran hutan', nilai: 'C' }, { teks: 'Debu alami', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Polusi udara di kota besar semakin meningkat dari tahun ke tahun. Padatnya kendaraan bermotor menjadi penyumbang utama pencemaran udara. Aktivitas industri juga memperburuk kualitas udara. Kondisi ini berdampak pada kesehatan masyarakat. Anak-anak dan lansia menjadi kelompok yang paling rentan.

Dampak polusi udara paling rentan dirasakan oleh...`,
                    opsi: [{ teks: 'Semua kelompok sama', nilai: 'A' }, { teks: 'Anak-anak dan lansia', nilai: 'B' }, { teks: 'Wisatawan', nilai: 'C' }, { teks: 'Pekerja kantor', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Polusi udara di kota besar semakin meningkat dari tahun ke tahun. Padatnya kendaraan bermotor menjadi penyumbang utama pencemaran udara. Aktivitas industri juga memperburuk kualitas udara. Kondisi ini berdampak pada kesehatan masyarakat. Anak-anak dan lansia menjadi kelompok yang paling rentan.

Jenis teks tersebut adalah...`,
                    opsi: [{ teks: 'Narasi', nilai: 'A' }, { teks: 'Deskripsi', nilai: 'B' }, { teks: 'Eksposisi', nilai: 'C' }, { teks: 'Puisi', nilai: 'D' }], kunci: 'C'
                },
                // TEKS 3 - Festival Budaya (5 soal) [citation:1]
                {
                    tipe: 'pg', teks: `Festival budaya daerah diselenggarakan setiap tahun. Kegiatan ini bertujuan melestarikan tradisi yang mulai jarang dikenal generasi muda. Berbagai pertunjukan seni dan musik daerah ditampilkan. Kuliner khas juga menjadi daya tarik pengunjung. Festival ini memperkenalkan kekayaan budaya lokal.

Tujuan diadakannya festival budaya adalah...`,
                    opsi: [{ teks: 'Menarik investor', nilai: 'A' }, { teks: 'Melestarikan tradisi', nilai: 'B' }, { teks: 'Meningkatkan politik', nilai: 'C' }, { teks: 'Menghibur wisatawan asing', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Festival budaya daerah diselenggarakan setiap tahun. Kegiatan ini bertujuan melestarikan tradisi yang mulai jarang dikenal generasi muda. Berbagai pertunjukan seni dan musik daerah ditampilkan. Kuliner khas juga menjadi daya tarik pengunjung. Festival ini memperkenalkan kekayaan budaya lokal.

Kegiatan yang ditampilkan dalam festival adalah...`,
                    opsi: [{ teks: 'Olahraga tradisional', nilai: 'A' }, { teks: 'Pameran teknologi', nilai: 'B' }, { teks: 'Seni dan kuliner daerah', nilai: 'C' }, { teks: 'Pertunjukan film', nilai: 'D' }], kunci: 'C'
                },
                {
                    tipe: 'pg', teks: `Festival budaya daerah diselenggarakan setiap tahun. Kegiatan ini bertujuan melestarikan tradisi yang mulai jarang dikenal generasi muda. Berbagai pertunjukan seni dan musik daerah ditampilkan. Kuliner khas juga menjadi daya tarik pengunjung. Festival ini memperkenalkan kekayaan budaya lokal.

Sasaran utama festival adalah...`,
                    opsi: [{ teks: 'Pejabat', nilai: 'A' }, { teks: 'Generasi muda', nilai: 'B' }, { teks: 'Investor', nilai: 'C' }, { teks: 'Wisatawan asing', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Festival budaya daerah diselenggarakan setiap tahun. Kegiatan ini bertujuan melestarikan tradisi yang mulai jarang dikenal generasi muda. Berbagai pertunjukan seni dan musik daerah ditampilkan. Kuliner khas juga menjadi daya tarik pengunjung. Festival ini memperkenalkan kekayaan budaya lokal.

Gagasan utama teks terdapat pada...`,
                    opsi: [{ teks: 'Kalimat pertama', nilai: 'A' }, { teks: 'Kalimat kedua', nilai: 'B' }, { teks: 'Kalimat terakhir', nilai: 'C' }, { teks: 'Semua kalimat', nilai: 'D' }], kunci: 'A'
                },
                // TEKS 4 - Ani Belajar (4 soal) [citation:1]
                {
                    tipe: 'pg', teks: `Ani membiasakan diri belajar secara teratur setiap hari sepulang sekolah. Ia menyusun jadwal agar tugas dapat selesai tepat waktu. Di kelas, Ani aktif bertanya jika ada materi yang belum dipahami. Kebiasaan ini membuatnya lebih percaya diri. Nilai ulangan Ani pun terus meningkat.

Sikap Ani menunjukkan bahwa ia...`,
                    opsi: [{ teks: 'Mudah menyerah', nilai: 'A' }, { teks: 'Bertanggung jawab', nilai: 'B' }, { teks: 'Terpaksa belajar', nilai: 'C' }, { teks: 'Malas', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Ani membiasakan diri belajar secara teratur setiap hari sepulang sekolah. Ia menyusun jadwal agar tugas dapat selesai tepat waktu. Di kelas, Ani aktif bertanya jika ada materi yang belum dipahami. Kebiasaan ini membuatnya lebih percaya diri. Nilai ulangan Ani pun terus meningkat.

Dampak dari kebiasaan Ani adalah...`,
                    opsi: [{ teks: 'Nilai menurun', nilai: 'A' }, { teks: 'Prestasi meningkat', nilai: 'B' }, { teks: 'Sering dimarahi guru', nilai: 'C' }, { teks: 'Tidak naik kelas', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 5 - Lingkungan Rumah (4 soal) [citation:2]
                {
                    tipe: 'pg', teks: `Hujan deras turun sejak malam hari di lingkungan tempat tinggal Budi. Saluran air yang tersumbat sampah membuat air tidak mengalir lancar. Akibatnya, jalan dan halaman rumah tergenang air. Kondisi ini mengganggu aktivitas warga. Warga mulai menyadari pentingnya menjaga kebersihan lingkungan.

Penyebab utama genangan air adalah...`,
                    opsi: [{ teks: 'Curah hujan ringan', nilai: 'A' }, { teks: 'Saluran air tersumbat', nilai: 'B' }, { teks: 'Tanah cekung', nilai: 'C' }, { teks: 'Sungai meluap', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Hujan deras turun sejak malam hari di lingkungan tempat tinggal Budi. Saluran air yang tersumbat sampah membuat air tidak mengalir lancar. Akibatnya, jalan dan halaman rumah tergenang air. Kondisi ini mengganggu aktivitas warga. Warga mulai menyadari pentingnya menjaga kebersihan lingkungan.

Kesimpulan yang tepat dari teks adalah...`,
                    opsi: [{ teks: 'Hujan selalu menyebabkan banjir', nilai: 'A' }, { teks: 'Kebersihan lingkungan perlu dijaga', nilai: 'B' }, { teks: 'Jalan harus diperbaiki', nilai: 'C' }, { teks: 'Rumah harus ditinggikan', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 6 - Lampu Lalu Lintas (3 soal) [citation:2]
                {
                    tipe: 'pg', teks: `Lampu lalu lintas di persimpangan jalan utama menyala merah. Para pengendara menghentikan kendaraan dengan tertib. Tidak ada yang menerobos lampu merah. Pejalan kaki menyeberang dengan aman. Lalu lintas berjalan tertib dan nyaman.

Sikap pengendara menunjukkan...`,
                    opsi: [{ teks: 'Kepanikan', nilai: 'A' }, { teks: 'Kepatuhan', nilai: 'B' }, { teks: 'Kelalaian', nilai: 'C' }, { teks: 'Ketakutan', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Lampu lalu lintas di persimpangan jalan utama menyala merah. Para pengendara menghentikan kendaraan dengan tertib. Tidak ada yang menerobos lampu merah. Pejalan kaki menyeberang dengan aman. Lalu lintas berjalan tertib dan nyaman.

Manfaat sikap tersebut adalah...`,
                    opsi: [{ teks: 'Menghemat waktu', nilai: 'A' }, { teks: 'Menjaga keselamatan', nilai: 'B' }, { teks: 'Menghindari hujan', nilai: 'C' }, { teks: 'Mempercepat laju', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 7 - Raka dan Lingkungan (3 soal) [citation:2]
                {
                    tipe: 'pg', teks: `Raka membawa botol minum sendiri ke sekolah setiap hari. Ia menghindari minuman kemasan sekali pakai. Menurut Raka, sampah plastik sulit terurai. Kebiasaan ini membuatnya lebih hemat. Teman-temannya mulai meniru sikap Raka.

Alasan Raka membawa botol sendiri adalah...`,
                    opsi: [{ teks: 'Tidak suka minuman dingin', nilai: 'A' }, { teks: 'Peduli lingkungan', nilai: 'B' }, { teks: 'Disuruh guru', nilai: 'C' }, { teks: 'Tidak punya uang', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Raka membawa botol minum sendiri ke sekolah setiap hari. Ia menghindari minuman kemasan sekali pakai. Menurut Raka, sampah plastik sulit terurai. Kebiasaan ini membuatnya lebih hemat. Teman-temannya mulai meniru sikap Raka.

Dampak dari sikap Raka bagi lingkungan adalah...`,
                    opsi: [{ teks: 'Menambah sampah', nilai: 'A' }, { teks: 'Mengurangi sampah plastik', nilai: 'B' }, { teks: 'Memboroskan uang', nilai: 'C' }, { teks: 'Mengganggu teman', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 8 - Nelayan (3 soal) [citation:2]
                {
                    tipe: 'pg', teks: `Cuaca mendung disertai angin kencang terjadi sejak pagi hari. Gelombang laut terlihat tinggi. Para nelayan mempertimbangkan risiko melaut. Demi keselamatan, mereka menunda aktivitas. Waktu dimanfaatkan untuk memperbaiki peralatan.

Keputusan nelayan didasarkan pada...`,
                    opsi: [{ teks: 'Kemalasan', nilai: 'A' }, { teks: 'Keselamatan', nilai: 'B' }, { teks: 'Permintaan pasar', nilai: 'C' }, { teks: 'Jadwal kerja', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Cuaca mendung disertai angin kencang terjadi sejak pagi hari. Gelombang laut terlihat tinggi. Para nelayan mempertimbangkan risiko melaut. Demi keselamatan, mereka menunda aktivitas. Waktu dimanfaatkan untuk memperbaiki peralatan.

Sikap nelayan mencerminkan sifat...`,
                    opsi: [{ teks: 'Ceroboh', nilai: 'A' }, { teks: 'Bijaksana', nilai: 'B' }, { teks: 'Acuh', nilai: 'C' }, { teks: 'Terburu-buru', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 9 - Kebersihan Kelas (2 soal) [citation:2]
                {
                    tipe: 'pg', teks: `Ruang kelas yang bersih dan rapi menciptakan suasana belajar nyaman. Meja dan kursi tertata dengan baik. Tidak ada sampah berserakan. Siswa lebih fokus saat pelajaran. Guru pun mudah menyampaikan materi.

Kesimpulan yang tepat adalah...`,
                    opsi: [{ teks: 'Kebersihan meningkatkan konsentrasi', nilai: 'A' }, { teks: 'Guru menentukan fokus siswa', nilai: 'B' }, { teks: 'Belajar harus di luar kelas', nilai: 'C' }, { teks: 'Kebersihan tidak penting', nilai: 'D' }], kunci: 'A'
                },
                {
                    tipe: 'pg', teks: `Ruang kelas yang bersih dan rapi menciptakan suasana belajar nyaman. Meja dan kursi tertata dengan baik. Tidak ada sampah berserakan. Siswa lebih fokus saat pelajaran. Guru pun mudah menyampaikan materi.

Teks menekankan pentingnya...`,
                    opsi: [{ teks: 'Media belajar', nilai: 'A' }, { teks: 'Lingkungan belajar', nilai: 'B' }, { teks: 'Disiplin waktu', nilai: 'C' }, { teks: 'Metode mengajar', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 10 - Respon Penonton (3 soal) [citation:2]
                {
                    tipe: 'pg', teks: `Setelah film berakhir, penonton keluar dari bioskop dengan wajah puas. Mereka membicarakan adegan favorit. Beberapa merekomendasikan film kepada teman. Respons penonton terlihat positif. Film tersebut meninggalkan kesan mendalam.

Penilaian penonton terhadap film adalah...`,
                    opsi: [{ teks: 'Membosankan', nilai: 'A' }, { teks: 'Mengecewakan', nilai: 'B' }, { teks: 'Menarik', nilai: 'C' }, { teks: 'Biasa saja', nilai: 'D' }], kunci: 'C'
                },
                {
                    tipe: 'pg', teks: `Setelah film berakhir, penonton keluar dari bioskop dengan wajah puas. Mereka membicarakan adegan favorit. Beberapa merekomendasikan film kepada teman. Respons penonton terlihat positif. Film tersebut meninggalkan kesan mendalam.

Informasi tersebut bersifat...`,
                    opsi: [{ teks: 'Tersurat', nilai: 'A' }, { teks: 'Tersirat', nilai: 'B' }, { teks: 'Fakta ilmiah', nilai: 'C' }, { teks: 'Data statistik', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Setelah film berakhir, penonton keluar dari bioskop dengan wajah puas. Mereka membicarakan adegan favorit. Beberapa merekomendasikan film kepada teman. Respons penonton terlihat positif. Film tersebut meninggalkan kesan mendalam.

Kata "puas" menunjukkan perasaan...`,
                    opsi: [{ teks: 'Marah', nilai: 'A' }, { teks: 'Senang', nilai: 'B' }, { teks: 'Takut', nilai: 'C' }, { teks: 'Sedih', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 11 - Puisi (2 soal) [citation:2]
                {
                    tipe: 'pg', teks: `Langit senja memerah perlahan di ufuk barat. Cahaya matahari meredup dengan lembut. Angin berembus pelan. Suasana terasa damai. Pemandangan tersebut menenangkan hati.

Suasana yang digambarkan dalam teks adalah...`,
                    opsi: [{ teks: 'Ramai', nilai: 'A' }, { teks: 'Damai', nilai: 'B' }, { teks: 'Mencekam', nilai: 'C' }, { teks: 'Gembira', nilai: 'D' }], kunci: 'B'
                },
                // TEKS 12 - Puisi Perempuan Perkasa (2 soal) [citation:10]
                {
                    tipe: 'pg', teks: `Perempuan-perempuan yang membawa bakul di pagi buta,
dari manakah mereka
Ke stasiun kereta mereka datang dari bukit-bukit desa
sebelum peluit kereta pagi terjaga
sebelum hari bermula dalam pesta kerja

Perempuan-perempuan yang membawa bakul dalam kereta,
ke manakah mereka
Di atas roda-roda baja mereka berkendara
Mereka berlomba dengan surya menuju ke gerbang kota
merebut hidup di pasar-pasar kota

Perempuan-perempuan yang membawa bakul di pagi buta, siapakah mereka
Mereka ialah ibu-ibu yang perkasa
akar-akar yang melata dari tanah perbukitan turun ke kota
Mereka: cinta kasih yang bergerak menghidupi desa demi desa

Tokoh yang digambarkan dalam puisi tersebut adalah...`,
                    opsi: [{ teks: 'Gadis-gadis desa', nilai: 'A' }, { teks: 'Ibu-ibu perkasa', nilai: 'B' }, { teks: 'Pedagang pasar', nilai: 'C' }, { teks: 'Pekerja pabrik', nilai: 'D' }], kunci: 'B'
                },
                {
                    tipe: 'pg', teks: `Perempuan-perempuan yang membawa bakul di pagi buta,
dari manakah mereka
Ke stasiun kereta mereka datang dari bukit-bukit desa
sebelum peluit kereta pagi terjaga
sebelum hari bermula dalam pesta kerja

Perempuan-perempuan yang membawa bakul dalam kereta,
ke manakah mereka
Di atas roda-roda baja mereka berkendara
Mereka berlomba dengan surya menuju ke gerbang kota
merebut hidup di pasar-pasar kota

Perempuan-perempuan yang membawa bakul di pagi buta, siapakah mereka
Mereka ialah ibu-ibu yang perkasa
akar-akar yang melata dari tanah perbukitan turun ke kota
Mereka: cinta kasih yang bergerak menghidupi desa demi desa

Aktivitas yang dilakukan tokoh dalam puisi adalah...`,
                    opsi: [{ teks: 'Berjualan di pasar', nilai: 'A' }, { teks: 'Pergi ke kota membawa bakul', nilai: 'B' }, { teks: 'Bekerja di pabrik', nilai: 'C' }, { teks: 'Menjadi guru', nilai: 'D' }], kunci: 'B'
                },
                // PGK (3 soal)
                {
                    tipe: 'pgk', teks: `Perpustakaan sekolah kini berfungsi sebagai pusat belajar siswa. Selain menyediakan buku pelajaran, perpustakaan juga memiliki koleksi buku pengayaan dan karya sastra. Siswa dapat memanfaatkan fasilitas ini untuk belajar mandiri. Guru sering mendorong siswa mencari referensi tambahan dari perpustakaan.

Manfaat yang diperoleh siswa dari perpustakaan menurut teks adalah... (pilih semua yang sesuai)`,
                    opsi: [{ teks: 'Mendapatkan buku pelajaran', nilai: 'A' }, { teks: 'Membaca karya sastra', nilai: 'B' }, { teks: 'Belajar mandiri', nilai: 'C' }, { teks: 'Bertemu teman', nilai: 'D' }], kunci: ['A', 'B', 'C']
                },
                {
                    tipe: 'pgk', teks: `Polusi udara di kota besar semakin meningkat dari tahun ke tahun. Padatnya kendaraan bermotor menjadi penyumbang utama pencemaran udara. Aktivitas industri juga memperburuk kualitas udara. Kondisi ini berdampak pada kesehatan masyarakat. Anak-anak dan lansia menjadi kelompok yang paling rentan.

Penyebab polusi udara dalam teks adalah... (pilih semua)`,
                    opsi: [{ teks: 'Kendaraan bermotor', nilai: 'A' }, { teks: 'Aktivitas industri', nilai: 'B' }, { teks: 'Limbah rumah tangga', nilai: 'C' }, { teks: 'Kebakaran hutan', nilai: 'D' }], kunci: ['A', 'B']
                },
                {
                    tipe: 'pgk', teks: `Festival budaya daerah diselenggarakan setiap tahun. Kegiatan ini bertujuan melestarikan tradisi yang mulai jarang dikenal generasi muda. Berbagai pertunjukan seni dan musik daerah ditampilkan. Kuliner khas juga menjadi daya tarik pengunjung.

Kegiatan yang ada dalam festival adalah... (pilih semua)`,
                    opsi: [{ teks: 'Pertunjukan seni', nilai: 'A' }, { teks: 'Musik daerah', nilai: 'B' }, { teks: 'Kuliner khas', nilai: 'C' }, { teks: 'Pameran teknologi', nilai: 'D' }], kunci: ['A', 'B', 'C']
                }
            ];

            // ==================== BANK SOAL MATEMATIKA (30 SOAL) ====================
            const bankMat = [
                { tipe: 'pg', teks: 'Hasil dari (-12) : 3 + (-8) x (-5) adalah...\nA. -44\nB. -36\nC. 36\nD. 44', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'D' },
                { tipe: 'pg', teks: 'Dalam kompetisi Olimpiade Matematika, setiap butir soal dijawab benar diberi skor 5, salah -2, dan tidak dijawab -1. Dari 40 butir soal, Andi menjawab benar 30 butir dan salah 6 butir. Skor yang diperoleh Andi adalah...\nA. 132\nB. 138\nC. 142\nD. 148', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'B' },
                { tipe: 'pg', teks: 'Sebuah mobil menempuh jarak dari kota A ke kota B dalam waktu 1,6 jam dengan kecepatan rata-rata 75 km/jam. Jika mobil ingin menempuh jarak yang sama dalam waktu 1 jam, kecepatan rata-rata yang harus dicapai adalah... km/jam\nA. 100\nB. 110\nC. 120\nD. 130', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'C' },
                { tipe: 'pg', teks: 'Hasil dari 227 + 33 / 12 adalah...\nA. 33\nB. 43\nC. 53\nD. 63', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'C' },
                { tipe: 'pg', teks: 'Diketahui 3(4x + 3) = 6x - 15. Jika n adalah penyelesaian dari persamaan tersebut, nilai dari 3n + 7 adalah...\nA. -5\nB. -2\nC. 2\nD. 5', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Bayu akan membeli baju sejenis secara online dengan harga Rp55.000 per potong. Setiap transaksi dikenakan ongkos kirim Rp15.000 (berapapun jumlah baju). Jika Bayu memiliki uang Rp385.000, jumlah maksimum baju yang dapat dibeli adalah...\nA. 5\nB. 6\nC. 7\nD. 8', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'B' },
                { tipe: 'pg', teks: 'Sebuah dadu dilambungkan satu kali. Peluang muncul mata dadu faktor dari 6 adalah...\nA. 1/6\nB. 1/2\nC. 2/3\nD. 5/6', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'C' },
                { tipe: 'pg', teks: 'Sebuah keluarga ingin memiliki 2 anak saja. Jika peluang lahir anak laki-laki dan perempuan sama, peluang kedua anaknya perempuan adalah...\nA. 1/4\nB. 1/2\nC. 3/4\nD. 1', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Kebun berbentuk belah ketupat, panjang kedua diagonalnya 24 m dan 18 m. Di sekelilingnya ditanami pohon dengan jarak antar pohon 3 m. Banyaknya pohon adalah...\nA. 14\nB. 15\nC. 20\nD. 28', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'C' },
                { tipe: 'pg', teks: 'Persamaan garis melalui titik (-3,2) dan sejajar dengan garis 2x + 3y = 6 adalah...\nA. 2x + 3y = -8\nB. 2x + 3y = 0\nC. 2x - 3y = -4\nD. 2x - 3y = 0', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'B' },
                { tipe: 'pg', teks: 'Penyelesaian sistem persamaan x + y = 7 dan x - y = 3 adalah...\nA. (2,5)\nB. (5,2)\nC. (-3,10)\nD. (10,-3)', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'B' },
                { tipe: 'pg', teks: 'Penyelesaian dari 3x + 10 > 6x - 8 adalah...\nA. x < 2\nB. x > 2\nC. x < 6\nD. x > 6', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'C' },
                { tipe: 'pg', teks: 'Dari 143 siswa, 95 siswa senang matematika, 87 siswa senang fisika, dan 60 siswa senang keduanya. Banyak siswa yang tidak senang matematika maupun fisika adalah...\nA. 21 orang\nB. 27 orang\nC. 35 orang\nD. 122 orang', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Diketahui fungsi f(x) = 2x - 3. Nilai f(-1) adalah...\nA. 5\nB. 1\nC. -1\nD. -5', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'D' },
                { tipe: 'pg', teks: 'Diketahui f(x) = 8 - 2x. Jika f(a) = -2 maka nilai a adalah...\nA. -5\nB. -3\nC. 3\nD. 5', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'D' },
                { tipe: 'pg', teks: 'Hasil dari -6 + (6 / (-2)) - ((-3) x 3) adalah...\nA. 0\nB. 3\nC. 6\nD. 9', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Tali yang panjangnya 10 meter akan dipotong menjadi beberapa bagian yang sama panjang. Jika tiap bagian panjangnya 1/4 meter, banyak potongan tali adalah...\nA. 30\nB. 35\nC. 40\nD. 45', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'C' },
                { tipe: 'pg', teks: 'Untuk membuat 20 roti diperlukan 4 kg tepung terigu. Banyak tepung terigu yang diperlukan untuk membuat 50 roti adalah...\nA. 8 kg\nB. 10 kg\nC. 12 kg\nD. 14 kg', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'B' },
                { tipe: 'pg', teks: 'Suatu proyek diselesaikan oleh 30 pekerja dalam 6 bulan. Jika proyek itu harus diselesaikan dalam 4 bulan, banyak pekerja yang harus ditambah sebanyak...\nA. 10 orang\nB. 15 orang\nC. 20 orang\nD. 25 orang', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'B' },
                { tipe: 'pg', teks: 'Hasil dari 10 adalah...\nA. -100\nB. -20\nC. 0,2\nD. 0,01', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'D' },
                { tipe: 'pg', teks: 'Harga setengah kilogram cabe rawit hari ini Rp35.000. Jika Ibu membeli cabe rawit 2 1/4 kilogram, total harga yang harus dibayar adalah...\nA. Rp175.000\nB. Rp157.500\nC. Rp140.000\nD. Rp87.500', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'B' },
                { tipe: 'pg', teks: 'Andi menabung Rp800.000 di bank dengan bunga 6% per tahun. Jumlah tabungan Andi setelah 9 bulan adalah...\nA. Rp836.000\nB. Rp840.000\nC. Rp848.000\nD. Rp854.000', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Tentukan penyelesaian dari persamaan 3(x + 5)  (x  3) = 36 adalah...\nA. x = 9\nB. x = 20\nC. x = 24\nD. x = 27', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Diketahui barisan aritmetika 4, 6, p, 10, 12, 14, q, ... Nilai p + q adalah...\nA. 24\nB. 26\nC. 28\nD. 30', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Seorang pelari marathon berlatih setiap hari. Pada hari pertama ia menempuh jarak 10 km, dan setiap hari berikutnya ia selalu menambah jarak larinya sejauh 2 km. Jika pelari tersebut berlatih selama 10 hari, jumlah jarak total yang telah ia tempuh adalah...\nA. 100 km\nB. 120 km\nC. 190 km\nD. 200 km', opsi: [{ teks: 'A', nilai: 'A' }, { teks: 'B', nilai: 'B' }, { teks: 'C', nilai: 'C' }, { teks: 'D', nilai: 'D' }], kunci: 'C' },
                { tipe: 'pgk', teks: 'Bilangan prima antara 10 dan 20 adalah... (pilih semua)', opsi: [{ teks: '11', nilai: 'A' }, { teks: '13', nilai: 'B' }, { teks: '17', nilai: 'C' }, { teks: '19', nilai: 'D' }], kunci: ['A', 'B', 'C', 'D'] },
                { tipe: 'pgk', teks: 'Sifat-sifat persegi panjang adalah... (pilih semua)', opsi: [{ teks: 'Sisi berhadapan sejajar', nilai: 'A' }, { teks: 'Keempat sisi sama panjang', nilai: 'B' }, { teks: 'Sudut siku-siku', nilai: 'C' }, { teks: 'Diagonal berpotongan tegak lurus', nilai: 'D' }], kunci: ['A', 'C'] },
                { tipe: 'pgk', teks: 'Faktor dari 12 adalah... (pilih semua)', opsi: [{ teks: '1', nilai: 'A' }, { teks: '2', nilai: 'B' }, { teks: '3', nilai: 'C' }, { teks: '4', nilai: 'D' }, { teks: '6', nilai: 'E' }, { teks: '12', nilai: 'F' }], kunci: ['A', 'B', 'C', 'D', 'E', 'F'] },
                { tipe: 'bs', teks: 'Bilangan 0 adalah bilangan cacah. (Benar/Salah)', opsi: [{ teks: 'Benar', nilai: true }, { teks: 'Salah', nilai: false }], kunci: true },
                { tipe: 'bs', teks: 'Rumus volume kerucut adalah 1/3    r  t. (Benar/Salah)', opsi: [{ teks: 'Benar', nilai: true }, { teks: 'Salah', nilai: false }], kunci: true }
            ];

            // ==================== TES KARAKTER (5 soal) ====================
            const soalKarakter = [
                { tipe: 'pg', teks: 'Apakah Anda memiliki motivasi tinggi untuk belajar?', opsi: [{ teks: 'Ya, selalu', nilai: 'A' }, { teks: 'Kadang-kadang', nilai: 'B' }, { teks: 'Tidak terlalu', nilai: 'C' }, { teks: 'Tidak sama sekali', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Bagaimana sikap Anda terhadap tantangan akademik?', opsi: [{ teks: 'Sangat antusias', nilai: 'A' }, { teks: 'Biasa saja', nilai: 'B' }, { teks: 'Cenderung menghindar', nilai: 'C' }, { teks: 'Takut', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Seberapa sering Anda belajar di luar jam sekolah?', opsi: [{ teks: 'Setiap hari', nilai: 'A' }, { teks: '3-4 kali seminggu', nilai: 'B' }, { teks: '1-2 kali seminggu', nilai: 'C' }, { teks: 'Tidak pernah', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Apakah Anda suka membaca buku selain pelajaran?', opsi: [{ teks: 'Sangat suka', nilai: 'A' }, { teks: 'Cukup suka', nilai: 'B' }, { teks: 'Kadang', nilai: 'C' }, { teks: 'Tidak suka', nilai: 'D' }], kunci: 'A' },
                { tipe: 'pg', teks: 'Bagaimana Anda mengatur waktu belajar?', opsi: [{ teks: 'Terjadwal rapi', nilai: 'A' }, { teks: 'Kadang terjadwal', nilai: 'B' }, { teks: 'Belajar jika ada tugas', nilai: 'C' }, { teks: 'Tidak pernah teratur', nilai: 'D' }], kunci: 'A' }
            ];

            // ==================== STATE ====================
            let currentToken = generateToken();
            let isLocked = false;
            let currentMapel = null;
            let jawabanKarakter = new Array(5).fill(null);
            let jawabanIndo = null;
            let jawabanMat = null;
            let soalIndoTerpilih = [];
            let soalMatTerpilih = [];
            let currentExitKey = '';
            let userData = { nama: '', gender: '', tgl: '', bln: '', thn: '' };
            let timerInterval = null;
            let waktuTersisa = 90 * 60;
            let awayTimer = null;
            let isPenaltyActive = false;
            let karakterSelesai = false;
            let indoSelesai = false;
            let matSelesai = false;
            let hasilKey = '';

            // Elemen DOM
            const loginPage = document.getElementById('loginPage');
            const karakterPage = document.getElementById('karakterPage');
            const pilihMapelPage = document.getElementById('pilihMapelPage');
            const konfirmasiPage = document.getElementById('konfirmasiPage');
            const konfirmasiMapel = document.getElementById('konfirmasiMapel');
            const indoPage = document.getElementById('indoPage');
            const matPage = document.getElementById('matPage');
            const hasilPage = document.getElementById('hasilPage');
            const modalSelesai = document.getElementById('modalSelesai');
            const tokenDisplay = document.getElementById('tokenDisplay');
            const tokenInput = document.getElementById('tokenInput');
            const namaInput = document.getElementById('namaInput');
            const btnLogin = document.getElementById('btnLogin');
            const loginError = document.getElementById('loginError');
            const penaltyMessage = document.getElementById('penaltyMessage');
            const namaDisplay = document.getElementById('namaDisplay');
            const karakterUser = document.getElementById('karakterUser');
            const indoUser = document.getElementById('indoUser');
            const matUser = document.getElementById('matUser');
            const karakterTimer = document.getElementById('karakterTimer');
            const indoTimer = document.getElementById('indoTimer');
            const matTimer = document.getElementById('matTimer');
            const batteryDisplay = document.getElementById('batteryDisplay');
            const batteryDisplayMat = document.getElementById('batteryDisplayMat');
            const karakterSoalContainer = document.getElementById('karakterSoalContainer');
            const indoSoalContainer = document.getElementById('indoSoalContainer');
            const matSoalContainer = document.getElementById('matSoalContainer');
            const submitKarakter = document.getElementById('submitKarakter');
            const submitIndo = document.getElementById('submitIndo');
            const submitMat = document.getElementById('submitMat');
            const btnIndo = document.getElementById('btnIndo');
            const btnMat = document.getElementById('btnMat');
            const btnLanjutSoal = document.getElementById('btnLanjutSoal');
            const btnBatalSelesai = document.getElementById('batalSelesai');
            const btnKonfirmasiSelesai = document.getElementById('konfirmasiSelesai');
            const karakterError = document.getElementById('karakterError');
            const indoError = document.getElementById('indoError');
            const matError = document.getElementById('matError');
            const hasilPanel = document.getElementById('hasilPanel');

            function generateToken() {
                const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
                let token = '';
                for (let i = 0; i < 6; i++) token += chars[Math.floor(Math.random() * chars.length)];
                return token;
            }
            tokenDisplay.textContent = currentToken;

            const tglSelect = document.getElementById('tgl');
            const blnSelect = document.getElementById('bln');
            const thnSelect = document.getElementById('thn');
            for (let i = 1; i <= 31; i++) { let opt = document.createElement('option'); opt.value = i; opt.textContent = i; tglSelect.appendChild(opt); }
            for (let i = 1; i <= 12; i++) { let opt = document.createElement('option'); opt.value = i; opt.textContent = i; blnSelect.appendChild(opt); }
            for (let i = 1980; i <= 2010; i++) { let opt = document.createElement('option'); opt.value = i; opt.textContent = i; thnSelect.appendChild(opt); }

            // ==================== FUNGSI BATERAI ====================
            function updateBattery() {
                if ('getBattery' in navigator) {
                    navigator.getBattery().then(function (battery) {
                        const level = Math.round(battery.level * 100);
                        let icon = 'fa-battery-empty';
                        if (level >= 90) icon = 'fa-battery-full';
                        else if (level >= 60) icon = 'fa-battery-three-quarters';
                        else if (level >= 40) icon = 'fa-battery-half';
                        else if (level >= 15) icon = 'fa-battery-quarter';
                        else icon = 'fa-battery-empty';
                        if (batteryDisplay) {
                            batteryDisplay.innerHTML = `<i class="fas ${icon}"></i> <span>${level}%</span>`;
                        }
                        if (batteryDisplayMat) {
                            batteryDisplayMat.innerHTML = `<i class="fas ${icon}"></i> <span>${level}%</span>`;
                        }
                        battery.addEventListener('levelchange', updateBattery);
                        battery.addEventListener('chargingchange', updateBattery);
                    });
                } else {
                    if (batteryDisplay) batteryDisplay.innerHTML = `<i class="fas fa-battery-full"></i> <span>100%</span>`;
                    if (batteryDisplayMat) batteryDisplayMat.innerHTML = `<i class="fas fa-battery-full"></i> <span>100%</span>`;
                }
            }

            // ==================== FUNGSI PENALTY 5 MENIT ====================
            function checkPenalty() {
                const penaltyEnd = localStorage.getItem('penaltyEnd');
                if (penaltyEnd) {
                    const now = Date.now();
                    const remaining = parseInt(penaltyEnd) - now;
                    if (remaining > 0) {
                        isPenaltyActive = true;
                        const minutes = Math.floor(remaining / 60000);
                        const seconds = Math.floor((remaining % 60000) / 1000);
                        penaltyMessage.style.display = 'block';
                        penaltyMessage.innerHTML = ` Anda terkena sanksi 5 menit karena keluar paksa. Silakan tunggu ${minutes} menit ${seconds} detik.`;
                        const countdown = setInterval(() => {
                            const remainingNow = parseInt(localStorage.getItem('penaltyEnd')) - Date.now();
                            if (remainingNow <= 0) {
                                clearInterval(countdown);
                                penaltyMessage.style.display = 'none';
                                isPenaltyActive = false;
                                localStorage.removeItem('penaltyEnd');
                            } else {
                                const mins = Math.floor(remainingNow / 60000);
                                const secs = Math.floor((remainingNow % 60000) / 1000);
                                penaltyMessage.innerHTML = ` Anda terkena sanksi 5 menit karena keluar paksa. Silakan tunggu ${mins} menit ${secs} detik.`;
                            }
                        }, 1000);
                        return true;
                    } else {
                        localStorage.removeItem('penaltyEnd');
                        isPenaltyActive = false;
                    }
                }
                return false;
            }

            function startViolationDetection() {
                document.addEventListener('visibilitychange', onVisibilityChange);
                window.addEventListener('blur', onBlur);
                window.addEventListener('focus', onFocus);
            }
            function stopViolationDetection() {
                document.removeEventListener('visibilitychange', onVisibilityChange);
                window.removeEventListener('blur', onBlur);
                window.removeEventListener('focus', onFocus);
                if (awayTimer) clearTimeout(awayTimer);
            }
            function onVisibilityChange() {
                if (document.hidden && isLocked) {
                    awayTimer = setTimeout(() => applyPenalty(), 2000);
                } else if (awayTimer) clearTimeout(awayTimer);
            }
            function onBlur() {
                if (isLocked) awayTimer = setTimeout(() => applyPenalty(), 2000);
            }
            function onFocus() { if (awayTimer) clearTimeout(awayTimer); }
            function applyPenalty() {
                if (!isLocked || isPenaltyActive) return;
                hentikanTimer();
                jawabanKarakter.fill(null);
                jawabanIndo = null;
                jawabanMat = null;
                const penaltyEnd = Date.now() + 5 * 60 * 1000;
                localStorage.setItem('penaltyEnd', penaltyEnd);
                exitFullscreen();
                setLock(false);
                loginPage.style.display = 'block';
                karakterPage.style.display = 'none';
                pilihMapelPage.style.display = 'none';
                konfirmasiPage.style.display = 'none';
                indoPage.style.display = 'none';
                matPage.style.display = 'none';
                hasilPage.style.display = 'none';
                checkPenalty();
                alert(' Keluar paksa! Jawaban di-reset + sanksi 5 menit.');
            }

            // ==================== LOGIN ====================
            btnLogin.addEventListener('click', () => {
                if (checkPenalty()) { loginError.textContent = 'Anda masih dalam masa sanksi.'; return; }
                const inputToken = tokenInput.value.trim().toUpperCase();
                const nama = namaInput.value.trim();
                const gender = document.querySelector('input[name="gender"]:checked')?.value;
                const tgl = tglSelect.value;
                const bln = blnSelect.value;
                const thn = thnSelect.value;
                if (inputToken === '') { loginError.textContent = 'Token harus diisi.'; return; }
                if (nama === '') { loginError.textContent = 'Nama harus diisi.'; return; }
                if (!gender) { loginError.textContent = 'Pilih jenis kelamin.'; return; }
                if (!tgl || !bln || !thn) { loginError.textContent = 'Tanggal lahir harus lengkap.'; return; }
                if (inputToken !== currentToken) { loginError.textContent = 'Token salah.'; return; }
                userData = { nama, gender, tgl, bln, thn };
                loginError.textContent = '';
                loginPage.style.display = 'none';
                karakterPage.style.display = 'block';
                karakterUser.textContent = `${nama} (${gender}) - ${tgl}/${bln}/${thn}`;
                renderSoal(karakterSoalContainer, 'karakter', soalKarakter, jawabanKarakter);
                waktuTersisa = 10 * 60;
                mulaiTimerKarakter();
                setLock(true);
                startViolationDetection();
                openFullscreen();
                updateBattery();
            });

            function mulaiTimerKarakter() {
                if (timerInterval) clearInterval(timerInterval);
                timerInterval = setInterval(() => {
                    if (waktuTersisa <= 0) {
                        clearInterval(timerInterval);
                        timerInterval = null;
                        karakterSelesai = true;
                        karakterPage.style.display = 'none';
                        pilihMapelPage.style.display = 'block';
                    } else {
                        waktuTersisa--;
                        karakterTimer.textContent = formatWaktu(waktuTersisa);
                    }
                }, 1000);
            }

            function mulaiTimerMapel(mapel) {
                if (timerInterval) clearInterval(timerInterval);
                waktuTersisa = 90 * 60;
                const timerElement = mapel === 'indo' ? indoTimer : matTimer;
                timerElement.textContent = formatWaktu(waktuTersisa);
                timerInterval = setInterval(() => {
                    if (waktuTersisa <= 0) {
                        clearInterval(timerInterval);
                        timerInterval = null;
                        if (mapel === 'indo') {
                            if (jawabanIndo && jawabanIndo.includes(null)) {
                                alert('Waktu habis! Beberapa soal belum dijawab.');
                            }
                            submitIndo.click();
                        } else {
                            if (jawabanMat && jawabanMat.includes(null)) {
                                alert('Waktu habis! Beberapa soal belum dijawab.');
                            }
                            submitMat.click();
                        }
                    } else {
                        waktuTersisa--;
                        timerElement.textContent = formatWaktu(waktuTersisa);
                    }
                }, 1000);
            }

            function hentikanTimer() {
                if (timerInterval) clearInterval(timerInterval);
                timerInterval = null;
            }

            function formatWaktu(detik) {
                let jam = Math.floor(detik / 3600);
                let menit = Math.floor((detik % 3600) / 60);
                let det = detik % 60;
                return `${jam.toString().padStart(2, '0')}:${menit.toString().padStart(2, '0')}:${det.toString().padStart(2, '0')}`;
            }

            function renderSoal(container, mapel, soalArray, jawabanArray) {
                let html = '';
                soalArray.forEach((soal, idx) => {
                    const nomor = idx + 1;
                    let tipeLabel = soal.tipe === 'pg' ? 'Pilihan Ganda' : (soal.tipe === 'pgk' ? 'PG Kompleks' : (soal.tipe === 'bs' ? 'Benar/Salah' : 'Menjodohkan'));
                    html += `<div class="soal-card" data-nomor="${idx}" data-tipe="${soal.tipe}"><div class="soal-header"><div class="soal-nomor">${nomor}</div><div class="soal-tipe">${tipeLabel}</div></div>`;
                    html += `<div class="soal-teks">${soal.teks}</div><div class="opsi">`;

                    if (soal.tipe === 'pg' || soal.tipe === 'pgk' || soal.tipe === 'bs') {
                        soal.opsi.forEach((opt, optIdx) => {
                            const inputType = (soal.tipe === 'pgk') ? 'checkbox' : 'radio';
                            const name = `opt_${mapel}_${idx}`;
                            let checked = false;
                            if (jawabanArray && jawabanArray[idx] !== null) {
                                if (soal.tipe === 'pgk') {
                                    checked = jawabanArray[idx].includes(opt.nilai);
                                } else {
                                    checked = (jawabanArray[idx] === opt.nilai);
                                }
                            }
                            html += `<div class="opsi-item"><input type="${inputType}" name="${name}" value="${opt.nilai}" id="${name}_${optIdx}" ${checked ? 'checked' : ''}><label for="${name}_${optIdx}">${opt.teks}</label></div>`;
                        });
                    }
                    html += `</div></div>`;
                });
                container.innerHTML = html;

                container.querySelectorAll('.soal-card').forEach((item) => {
                    const nomor = parseInt(item.dataset.nomor);
                    const tipe = item.dataset.tipe;
                    if (tipe === 'pg' || tipe === 'bs') {
                        const opsiDiv = item.querySelector('.opsi');
                        opsiDiv.addEventListener('change', (e) => {
                            const selected = opsiDiv.querySelector('input[type=radio]:checked');
                            if (selected) {
                                jawabanArray[nomor] = (tipe === 'bs') ? (selected.value === 'true') : selected.value;
                            }
                        });
                    } else if (tipe === 'pgk') {
                        const opsiDiv = item.querySelector('.opsi');
                        opsiDiv.addEventListener('change', (e) => {
                            const checkedValues = [];
                            opsiDiv.querySelectorAll('input[type=checkbox]:checked').forEach(cb => checkedValues.push(cb.value));
                            jawabanArray[nomor] = checkedValues;
                        });
                    }
                });
            }

            function pilihSoalAcak(bank, jumlah) {
                const shuffled = [...bank].sort(() => Math.random() - 0.5);
                return shuffled.slice(0, jumlah);
            }

            // ==================== TES KARAKTER ====================
            submitKarakter.addEventListener('click', () => {
                if (!semuaTerisi(karakterSoalContainer, jawabanKarakter)) {
                    karakterError.textContent = 'Semua soal harus dijawab!';
                    return;
                }
                karakterError.textContent = '';
                karakterSelesai = true;
                hentikanTimer();
                karakterPage.style.display = 'none';
                pilihMapelPage.style.display = 'block';
            });

            function semuaTerisi(container, jawabanArray) {
                return jawabanArray.every(v => v !== null);
            }

            // ==================== PILIH MAPEL & KONFIRMASI ====================
            btnIndo.addEventListener('click', () => {
                konfirmasiMapel.textContent = 'BAHASA INDONESIA';
                currentMapel = 'indo';
                pilihMapelPage.style.display = 'none';
                konfirmasiPage.style.display = 'block';
            });

            btnMat.addEventListener('click', () => {
                konfirmasiMapel.textContent = 'MATEMATIKA';
                currentMapel = 'mat';
                pilihMapelPage.style.display = 'none';
                konfirmasiPage.style.display = 'block';
            });

            btnLanjutSoal.addEventListener('click', () => {
                konfirmasiPage.style.display = 'none';
                if (currentMapel === 'indo') {
                    soalIndoTerpilih = pilihSoalAcak(bankIndo, 25);
                    jawabanIndo = new Array(25).fill(null);
                    indoPage.style.display = 'block';
                    indoUser.textContent = `${userData.nama} (${userData.gender}) - ${userData.tgl}/${userData.bln}/${userData.thn}`;
                    renderSoal(indoSoalContainer, 'indo', soalIndoTerpilih, jawabanIndo);
                    mulaiTimerMapel('indo');
                } else {
                    soalMatTerpilih = pilihSoalAcak(bankMat, 25);
                    jawabanMat = new Array(25).fill(null);
                    matPage.style.display = 'block';
                    matUser.textContent = `${userData.nama} (${userData.gender}) - ${userData.tgl}/${userData.bln}/${userData.thn}`;
                    renderSoal(matSoalContainer, 'mat', soalMatTerpilih, jawabanMat);
                    mulaiTimerMapel('mat');
                }
            });

            // ==================== SUBMIT MAPEL ====================
            submitIndo.addEventListener('click', () => {
                if (!jawabanIndo || !semuaTerisi(indoSoalContainer, jawabanIndo)) {
                    indoError.textContent = 'Semua soal harus dijawab!';
                    return;
                }
                indoSelesai = true;
                hentikanTimer();
                if (matSelesai) {
                    modalSelesai.classList.add('active');
                } else {
                    indoPage.style.display = 'none';
                    pilihMapelPage.style.display = 'block';
                }
            });

            submitMat.addEventListener('click', () => {
                if (!jawabanMat || !semuaTerisi(matSoalContainer, jawabanMat)) {
                    matError.textContent = 'Semua soal harus dijawab!';
                    return;
                }
                matSelesai = true;
                hentikanTimer();
                if (indoSelesai) {
                    modalSelesai.classList.add('active');
                } else {
                    matPage.style.display = 'none';
                    pilihMapelPage.style.display = 'block';
                }
            });

            btnBatalSelesai.addEventListener('click', () => {
                modalSelesai.classList.remove('active');
                if (currentMapel === 'indo') {
                    indoPage.style.display = 'none';
                } else {
                    matPage.style.display = 'none';
                }
                pilihMapelPage.style.display = 'block';
            });

            btnKonfirmasiSelesai.addEventListener('click', () => {
                modalSelesai.classList.remove('active');
                tampilkanHasilAkhir();
            });

            function semuaTerisi(container, jawabanArray) {
                for (let i = 0; i < jawabanArray.length; i++) {
                    if (jawabanArray[i] === null) return false;
                    if (Array.isArray(jawabanArray[i]) && jawabanArray[i].length === 0) return false;
                }
                return true;
            }

            function hitungSkor(soalArray, jawabanArray) {
                let benar = 0;
                for (let i = 0; i < soalArray.length; i++) {
                    const soal = soalArray[i];
                    const jawab = jawabanArray[i];
                    if (soal.tipe === 'pg') {
                        if (jawab === soal.kunci) benar++;
                    } else if (soal.tipe === 'pgk') {
                        const kunciSet = new Set(soal.kunci);
                        const jawabSet = new Set(jawab);
                        if (kunciSet.size === jawabSet.size && [...kunciSet].every(k => jawabSet.has(k))) benar++;
                    } else if (soal.tipe === 'bs') {
                        if (jawab === soal.kunci) benar++;
                    }
                }
                return benar;
            }

            function tampilkanHasilAkhir() {
                const skorIndo = hitungSkor(soalIndoTerpilih, jawabanIndo);
                const skorMat = hitungSkor(soalMatTerpilih, jawabanMat);
                const totalSoal = 50;
                const totalBenar = skorIndo + skorMat;
                const persen = (totalBenar / totalSoal * 100).toFixed(2);
                hasilKey = 'EXIT-' + Math.random().toString(36).substring(2, 10).toUpperCase();
                currentExitKey = hasilKey;

                let rincianIndo = '<h3 style="margin:20px 0 10px;">Rincian Jawaban Bahasa Indonesia:</h3>';
                soalIndoTerpilih.forEach((soal, idx) => {
                    const jawab = jawabanIndo[idx];
                    const kunci = soal.kunci;
                    let status = 'salah';
                    let jawabTeks = Array.isArray(jawab) ? jawab.join(', ') : jawab;
                    if (soal.tipe === 'pg') {
                        if (jawab === kunci) status = 'benar';
                    } else if (soal.tipe === 'pgk') {
                        const kunciSet = new Set(soal.kunci);
                        const jawabSet = new Set(jawab);
                        if (kunciSet.size === jawabSet.size && [...kunciSet].every(k => jawabSet.has(k))) status = 'benar';
                    } else if (soal.tipe === 'bs') {
                        if (jawab === kunci) status = 'benar';
                    }
                    rincianIndo += `<div class="rincian-item ${status}">
                        <div class="rincian-header"><span>Soal ${idx + 1}</span> <span>${status === 'benar' ? '' : ''}</span></div>
                        <div class="jawaban-user">Jawaban Anda: ${jawabTeks}</div>
                        <div class="kunci-jawaban">Kunci: ${kunci}</div>
                    </div>`;
                });

                let rincianMat = '<h3 style="margin:20px 0 10px;">Rincian Jawaban Matematika:</h3>';
                soalMatTerpilih.forEach((soal, idx) => {
                    const jawab = jawabanMat[idx];
                    const kunci = soal.kunci;
                    let status = 'salah';
                    let jawabTeks = Array.isArray(jawab) ? jawab.join(', ') : jawab;
                    if (soal.tipe === 'pg') {
                        if (jawab === kunci) status = 'benar';
                    } else if (soal.tipe === 'pgk') {
                        const kunciSet = new Set(soal.kunci);
                        const jawabSet = new Set(jawab);
                        if (kunciSet.size === jawabSet.size && [...kunciSet].every(k => jawabSet.has(k))) status = 'benar';
                    } else if (soal.tipe === 'bs') {
                        if (jawab === kunci) status = 'benar';
                    }
                    rincianMat += `<div class="rincian-item ${status}">
                        <div class="rincian-header"><span>Soal ${idx + 1}</span> <span>${status === 'benar' ? '' : ''}</span></div>
                        <div class="jawaban-user">Jawaban Anda: ${jawabTeks}</div>
                        <div class="kunci-jawaban">Kunci: ${Array.isArray(kunci) ? kunci.join(', ') : kunci}</div>
                    </div>`;
                });

                let html = `
            <div class="nilai-box">Skor Akhir: ${totalBenar}/${totalSoal} (${persen}%)</div>
            <div style="margin:20px 0; font-size:1.5rem;">B.Indo: ${skorIndo}/25 | Matematika: ${skorMat}/25</div>
            ${rincianIndo}
            ${rincianMat}
            <div class="key-area">
                <div style="font-size:1.3rem;"> KELUAR KEY</div>
                <div class="key-string">${hasilKey}</div>
                <button class="copyKeyBtn" style="background:#2563eb; color:white; border:none; padding:12px 30px; border-radius:40px; margin-top:10px; cursor:pointer;"> Salin Key</button>
            </div>
            <div class="exit-form">
                <input type="text" id="exitKeyInput" placeholder="masukkan key keluar">
                <button id="exitBtn"> KELUAR</button>
            </div>
            <div class="peringatan"> Key salah tidak bisa keluar</div>
        `;
                hasilPanel.innerHTML = html;
                hasilPage.style.display = 'block';
                indoPage.style.display = 'none';
                matPage.style.display = 'none';
                pilihMapelPage.style.display = 'none';
                konfirmasiPage.style.display = 'none';

                document.querySelector('.copyKeyBtn').addEventListener('click', () => {
                    navigator.clipboard.writeText(hasilKey).then(() => alert('Key disalin!'));
                });
                document.getElementById('exitBtn').addEventListener('click', () => {
                    const input = document.getElementById('exitKeyInput').value.trim();
                    if (input === currentExitKey) {
                        alert(' Key benar. Keluar dari tes.');
                        exitFullscreen();
                        setLock(false);
                        stopViolationDetection();
                        location.reload();
                    } else {
                        alert(' Key salah!');
                    }
                });
            }

            // ==================== FUNGSI FULLSCREEN & LOCK ====================
            function setLock(lock) {
                isLocked = lock;
                if (lock) {
                    window.onbeforeunload = (e) => { e.preventDefault(); e.returnValue = 'Tes berlangsung! Gunakan KEY.'; return 'Tes berlangsung! Gunakan KEY.'; };
                    history.pushState(null, null, location.href);
                    window.addEventListener('popstate', preventBack);
                } else {
                    window.onbeforeunload = null;
                    window.removeEventListener('popstate', preventBack);
                }
            }
            function preventBack() { if (isLocked) { history.pushState(null, null, location.href); alert(' Tombol back diblokir!'); } }
            document.addEventListener('keydown', (e) => {
                if (!isLocked) return;
                const key = e.key, ctrl = e.ctrlKey, shift = e.shiftKey, alt = e.altKey;
                const blocked = [key === 'F12', ctrl && shift && (key === 'I' || key === 'J' || key === 'C'), ctrl && key === 'U', key === 'F5', ctrl && (key === 'r' || key === 'R'), ctrl && shift && (key === 'r' || key === 'R'), ctrl && (key === 'w' || key === 'W'), ctrl && (key === 'f4' || key === 'F4'), alt && (key === 'F4'), ctrl && (key === 't' || key === 'T' || key === 'n' || key === 'N'), ctrl && (key === 'p' || key === 'P'), ctrl && (key === 's' || key === 'S'), alt && (key === 'ArrowLeft' || key === 'ArrowRight'), key === 'PrintScreen'];
                if (blocked.includes(true)) { e.preventDefault(); alert(' Akses ditolak!'); return false; }
                if (ctrl || alt) { e.preventDefault(); alert(' Tombol kombinasi diblokir.'); return false; }
            });
            document.addEventListener('contextmenu', (e) => { if (isLocked) e.preventDefault(); });
            document.addEventListener('copy', (e) => { if (isLocked) e.preventDefault(); });
            document.addEventListener('cut', (e) => { if (isLocked) e.preventDefault(); });
            document.addEventListener('paste', (e) => { if (isLocked) e.preventDefault(); });
            setInterval(() => {
                if (isLocked && (window.outerWidth - window.innerWidth > 200 || window.outerHeight - window.innerHeight > 200)) {
                    alert(' DevTools terdeteksi!'); applyPenalty();
                }
            }, 1000);
            function openFullscreen() { let elem = document.documentElement; if (elem.requestFullscreen) elem.requestFullscreen(); else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen(); else if (elem.msRequestFullscreen) elem.msRequestFullscreen(); }
            function exitFullscreen() { if (document.exitFullscreen) document.exitFullscreen(); else if (document.webkitExitFullscreen) document.webkitExitFullscreen(); else if (document.msExitFullscreen) document.msExitFullscreen(); }

            checkPenalty();
        })();
    </script>
</body>

  </html>
